<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Авторизация</title>
    <link rel="stylesheet" href="styles/style.css">
    <link rel="stylesheet" href="styles/login.css">
</head>

<body>

    <div id="app">
        <div class="panel" style="background-color: #4682b4; padding: 10px; margin-bottom: 20px;">
            <button @click="go_back()">Назад</button>
        </div>

        <div class="login-form">
            <h2>Авторизация</h2>
            <form @submit.prevent="login">
                <div class="form-group">
                    <label for="username">Имя пользователя:</label>
                    <input type="text" id="username" v-model="username" required>
                </div>
                <div class="form-group">
                    <label for="password">Пароль:</label>
                    <input type="password" id="password" v-model="password" required>
                </div>
                <button type="submit">Войти</button>
            </form>
        </div>
    </div>


    <script src="https://cdn.jsdelivr.net/npm/vue@2"></script>
    <script>
        new Vue({
            el: '#app',
            data() {
                return {
                    username: '',
                    password: ''
                };
            },
            mounted() {

            },
            methods: {
                login() {
                    // Отправка запроса на сервер для авторизации
                    const userData = {
                        username: this.username,
                        password: this.password
                    };
                    this.request_post('login', userData)
                        .then(response => {
                            // Обработка успешной авторизации
                            console.log('Авторизация успешна:', response);
                            // Перенаправление на другую страницу или выполнение других действий
                        })
                        .catch(error => {
                            // Обработка ошибки авторизации
                            console.error('Ошибка авторизации:', error);
                            // Возможно, вывод сообщения об ошибке пользователю
                        });
                },
                request_get(method, args = ['']) {
                    return new Promise((resolve, reject) => {
                        const options = args.join('&');
                        const xhr = new XMLHttpRequest();
                        const url = 'http://127.0.0.1:8000/' + method + '?' + options;
                        console.log(url)
                        xhr.open('GET', url, true);
                        xhr.onreadystatechange = () => {
                            if (xhr.readyState === 4) {
                                if (xhr.status === 200) {
                                    const responseData = JSON.parse(xhr.responseText);
                                    resolve(responseData);
                                } else {
                                    reject('Request failed with status: ' + xhr.status);
                                }
                            }
                        };
                        xhr.send();
                    });
                },
                request_post(method, data = {}) {
                    return new Promise((resolve, reject) => {
                        const xhr = new XMLHttpRequest();
                        const url = 'http://127.0.0.1:8000/' + method;
                        xhr.open('POST', url, true);
                        xhr.setRequestHeader('Content-Type', 'application/json');
                        xhr.onreadystatechange = () => {
                            if (xhr.readyState === 4) {
                                if (xhr.status === 200) {
                                    const responseData = JSON.parse(xhr.responseText);
                                    resolve(responseData);
                                } else {
                                    reject('Request failed with status: ' + xhr.status);
                                }
                            }
                        };
                        xhr.send(JSON.stringify(data));
                    });
                },
                go_back() {
                    window.location.href = "index.html";
                },
            }
        });
    </script>

</body>

</html>