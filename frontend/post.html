<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>
    <link rel="stylesheet" href="styles/style.css">
</head>

<body>

    <div id="app">
        <div class="panel" style="background-color: #4682b4; padding: 10px; margin-bottom: 20px;">
            <button @click="go_back()">Назад</button>
        </div>

        <div class="post">
            <p>{{ data.username }}</p>
            <p>{{ data.date }}</p>
            <p>{{ data.text }}</p>
            <p>Chat ID: {{ data.chat_id }}</p>
        </div>
    </div>


    <script src="https://cdn.jsdelivr.net/npm/vue@2"></script>
    <script>
        new Vue({
            el: '#app',
            data() {
                return {
                    rotation_date: 0,
                    data: [],
                    desc_option: 'false'
                };
            },
            mounted() {
                this.parse_post_id()
            },
            methods: {
                request(type, method, args = ['']) {
                    return new Promise((resolve, reject) => {
                        const options = args.join('&');
                        const xhr = new XMLHttpRequest();
                        const url = 'http://127.0.0.1:8000/' + method + '?' + options;
                        console.log(url)
                        xhr.open(type, url, true);
                        xhr.onreadystatechange = () => {
                            if (xhr.readyState === 4) {
                                if (xhr.status === 200) {
                                    const responseData = JSON.parse(xhr.responseText);
                                    resolve(responseData);
                                } else {
                                    reject('Request failed with status: ' + xhr.status);
                                }
                            }
                        };
                        xhr.send();
                    });
                },
                get_post(id) {
                    this.request('GET', `get_message/${id}`).then(
                        data => {
                            this.data = data;
                        })
                },
                go_back() {
                    window.location.href = "index.html";
                },
                parse_post_id() {
                    urlParams = new URLSearchParams(window.location.search);
                    postId = urlParams.get('post_id');
                    if (postId) {
                        this.get_post(postId);
                    } else {
                        console.error("Post ID not found in the URL.");
                    }
                }
            }
        });
    </script>

</body>

</html>